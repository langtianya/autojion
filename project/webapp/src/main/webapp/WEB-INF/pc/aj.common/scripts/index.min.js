function getBrowser(c){rMsie=/(msie\s|trident.*rv:)([\w.]+)/,rFirefox=/(firefox)\/([\w.]+)/,rOpera=/(opera).+version\/([\w.]+)/,rChrome=/(chrome)\/([\w.]+)/,rSafari=/version\/([\w.]+).*(safari)/;var b=navigator.userAgent.toLowerCase();var a=rMsie.exec(b);if(a!=null){return"IE:"+a[2]}var a=rChrome.exec(b);if(a!=null){return a[1]+":"+a[2]}if(c){alert(c)}var a=rFirefox.exec(b);if(a!=null){return a[1]+":"+a[2]}var a=rOpera.exec(b);if(a!=null){return a[1]+":"+a[2]}var a=rSafari.exec(b);if(a!=null){return a[2]+":"+a[1]}return""}$(function(){$("#bodyContent").i18n();getBrowser($.i18n.get("prompt.browser.notSupported"));$("#lang").combobox({editable:false,panelHeight:"auto",onChange:function(f){if(f!=currentLang){window.location.href="index.pub?request_locale="+f}},onLoadSuccess:function(){$(this).combobox("setValue",currentLang)}});$("#loginBtn").click(function(){return d()});function d(){if(!$("#loginBox").form("validate")){$.messager.alert($.i18n.get("error"),$.i18n.get("validateError"),"error");return false}var f=$.messager.progress({title:$.i18n.get("prompt"),msg:$.i18n.get("waitingMessage")});$.ajax({type:"post",url:contextPath+"/login.pub",data:$("form#loginBox").serialize(),success:function(k,g,j){$.messager.progress("close");if(!k.success){$.messager.alert($.i18n.get("error"),k.msg||$.i18n.get("prompt.exception"),"error");return}var m=k.errorInt;if(m!="0"){if(m=="90"||m=="91"||m=="92"){var l=k.errorParams[0];e(m,l)}else{if(m=="11"){$.messager.alert($.i18n.get("error"),$.i18n.get("password.expiry"),"error",function(){window.location.href=contextPath+"/password.pub?expired=true&username="+encodeURI($("#username").val())})}else{var i=k.mappedErrorMsgs||[$.i18n.get("prompt.exception")];if(i!=null){$.messager.alert($.i18n.get("error"),i[0],"error")}}}}else{var h="index.pub";if(window.filterFrom!=""){h=filterFrom}window.location.href=h}},error:function(i,g,h){$.messager.progress("close");$.messager.alert($.i18n.get("error"),h||$.i18n.get("prompt.connection.exception"),"error")}});return false}function e(g,f){if(g=="90"){c(f)}else{if(g=="91"){b(f)}else{a()}}}function c(f){$("#ldapExpired90_content").html($.i18n.get("Authorize.ldap.passwordExpireDays",[f]));$("#ldapExpired90").dialog({title:$.i18n.get("Authorize.ldap.passwordExpirePrompt"),width:360,height:160,closed:false,cache:false,modal:true,buttons:[{text:$.i18n.get("Authorize.ldap.modifyPassword"),handler:function(){window.open(ldapPasswordChangeAddress)}},{text:$.i18n.get("Authorize.ldap.modifyPasswordNextTime"),handler:function(){window.location.href="index.pub"}}]})}function b(f){$("#ldapExpired91_content").html($.i18n.get("Authorize.ldap.passwordWillExpire",[f]));$("#ldapExpired91").dialog({title:$.i18n.get("Authorize.ldap.passwordExpirePrompt"),width:360,height:160,closed:false,cache:false,modal:true,buttons:[{text:$.i18n.get("Authorize.ldap.modifyPassword"),handler:function(){window.open(ldapPasswordChangeAddress)}},{text:$.i18n.get("Authorize.ldap.exitSystem"),handler:function(){window.location.href=contextPath+"/logout.pub"}}]})}function a(){$("#ldapExpired92").dialog({title:$.i18n.get("Authorize.ldap.passwordExpirePrompt"),width:360,height:180,closed:false,cache:false,modal:true,buttons:[{text:$.i18n.get("Authorize.ldap.exitSystem"),handler:function(){$("#ldapExpired92").dialog("close")}}]})}$("#username").keypress(function(f){if(f.keyCode==13){$("#password")[0].focus()}});$("#password").keypress(function(f){if(f.keyCode==13){if(verifyCodeActive){$("#verifyCode")[0].focus()}else{d()}}});if(verifyCodeActive){$("#verifyCode").keypress(function(f){if(f.keyCode==13){d()}})}$("#username")[0].focus()});