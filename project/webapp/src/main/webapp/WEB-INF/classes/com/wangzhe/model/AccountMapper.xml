<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wangzhe.model.AccountMapper">
    <resultMap type="com.wangzhe.model.Account" id="cc_account">
        <result column="cc_account" property="Account" javaType="com.wangzhe.model.Account"/>
    </resultMap>

    <insert id="insert" parameterType="com.wangzhe.model.Account">
        insert into cc_account(aName,aPwd,aPhone,aQq,uId,aStatus,aTotal,aLast,aDate,aIp,online,aAgent)
        values(#{aName},#{aPwd},#{aPhone},#{aQq},#{uId},#{aStatus},#{aTotal},#{aLast},#{aDate},#{aIp},#{online},#{aAgent})
        <!-- 这里sql结尾不能加分号，否则报“ORA-00911”的错误 -->
    </insert>

    <select id="getAccountByName" resultType="com.wangzhe.model.Account" parameterType="java.lang.String">
        select * from cc_account where aName=#{aName}
    </select>
    <select id="isOnline" resultType="java.lang.Boolean" parameterType="java.lang.Integer">
        select online from cc_account where aId=#{aId}
    </select>
    <select id="getAccountById" resultType="com.wangzhe.model.Account" parameterType="java.lang.String">
        select * from cc_account where aId=#{aId}
    </select>
    <select id="checkAccount" parameterType="com.wangzhe.model.Account" resultType="com.wangzhe.model.Account">
        <![CDATA[
       select * from cc_account where aName=#{aName} and aPwd=#{aPwd}
    ]]>
    </select>
    <select id="getAllAccounts" resultType="com.wangzhe.model.Account">
        select * from cc_account  order by aDate DESC limit 200
    </select>
    <delete id="deleteAccountById" parameterType="java.lang.String">
        delete from cc_account where aId=#{aId}
    </delete>
    <select id="getCountByIP" resultType="java.sql.Date">
        select aDate from cc_account where aIp=#{aIp}
    </select>
    <update id="update" parameterType="com.wangzhe.model.Account">
        update cc_account set aName=#{aName},aPhone=#{aPhone},aQq=#{aQq},aAgent=#{aAgent},aStatus=#{aStatus}
        where aId=#{aId}
    </update>
    <update id="desPoint" parameterType="java.lang.String">
        update cc_account set aLast=aLast-1 where aId=#{aId}
    </update>
    <update id="InscutPoint" parameterType="java.util.Map">
        update cc_account set aTotal=aTotal+#{point},aLast=aLast+#{point} where aId=#{aId}
    </update>

    <select id="getPoint" resultType="java.lang.String" parameterType="java.lang.String">
        select aLast from cc_account where aId=#{aId}
    </select>

    <select id="advanSearch" resultType="com.wangzhe.model.Account" parameterType="com.wangzhe.model.Account" >
        select * from cc_account where aName like '%${aName}%' and aPhone like '%${aPhone}%' and aQq like '%${aQq}%'
        and aDate >= '${aDate}' and aStatus like '%${aStatus}%' and aAgent like '%${aAgent}%' order by aDate DESC limit 200
    </select>
    <select id="advanSearchHaveEndDate" resultType="com.wangzhe.model.Account" parameterType="com.wangzhe.model.Account" >
       <![CDATA[ 
       select * from cc_account  where aName like '%${aName}%' and aPhone like '%${aPhone}%' and aQq like '%${aQq}%'
        and aDate <= '${serchEndDate}'  and aStatus like '%${aStatus}%' and aAgent like '%${aAgent}%' order by aDate DESC limit 200
    ]]>
    </select>
    <select id="advanSearchHaveDate" resultType="com.wangzhe.model.Account" parameterType="com.wangzhe.model.Account" >
        select * from cc_account where aName like '%${aName}%' and aPhone like '%${aPhone}%' and aQq like '%${aQq}%'
        and aDate between '${aDate}' and '${serchEndDate}'  and aStatus like '%${aStatus}%' and aAgent like '%${aAgent}%' order by aDate DESC limit 200
    </select>
    
    <!-- 
    <select id="advanSearch" resultType="com.wangzhe.model.Account" parameterType="com.wangzhe.model.Account" resultMap="accountResultMap">
        select * from cc_account LEFT JOIN cc_user  on cc_account.uId = cc_user.uId where aName like '%${aName}%' and aPhone like '%${aPhone}%' and aQq like '%${aQq}%'
        and aDate >= '${aDate}' and  uId like '%${uId}%' and aStatus like '%${aStatus}%' order by aDate DESC limit 200
    </select>
    <select id="advanSearchHaveEndDate" resultType="com.wangzhe.model.Account" parameterType="com.wangzhe.model.Account" resultMap="accountResultMap">
       <![CDATA[ 
       select * from cc_account LEFT JOIN cc_user  on cc_account.uId = cc_user.uId where aName like '%${aName}%' and aPhone like '%${aPhone}%' and aQq like '%${aQq}%'
        and aDate <= '${serchEndDate}' and  uId like '%${uId}%' and aStatus like '%${aStatus}%' order by aDate DESC limit 200
    ]]>
    </select>
    <select id="advanSearchHaveDate" resultType="com.wangzhe.model.Account" parameterType="com.wangzhe.model.Account" resultMap="accountResultMap">
        select * from cc_account LEFT JOIN cc_user  on cc_account.uId = cc_user.uId
         where aName like '%${aName}%' and aPhone like '%${aPhone}%' and aQq like '%${aQq}%'
        and aDate between '${aDate}' and '${serchEndDate}' and uId like '%${uId}%' and aStatus like '%${aStatus}%' order by aDate DESC limit 200
    </select>
     -->
     <!-- 数据库字段和Bean对象字段映射 
 <resultMap type="account" id="accountResultMap">
  <id property="aId" column="aId"/>
  <result property="aName" column="aName"/>
  <result property="aPwd" column="aPwd"/>
  <result property="aPhone" column="aPhone"/>
  <result property="aQq" column="aQq"/>
  <result property="uId" column="uId"/>
  <result property="aStatus" column="aStatus"/>
  <result property="aTotal" column="aTotal"/>
  <result property="aLast" column="aLast"/>
  <result property="aDate" column="aDate"/>
  <result property="aIp" column="aIp"/>
  <result property="online" column="online"/>-->
  
  <!-- 联合查询 property中的名字应该和deptBean这个名字一致
   column中的名字应该和查询时的别名一样 
  <association property="userBean" column="uId" javaType="user">
   <id property="uId" column="uId"/>
   <result property="uName" column="uName"/>
   <result property="uPwd" column="uPwd"/>
   <result property="uAgents" column="uAgents"/>
   <result property="uAuth" column="uAuth"/>
   <result property="uDate" column="uDate"/>
  </association>
 </resultMap>-->
    
</mapper>